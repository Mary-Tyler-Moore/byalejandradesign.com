sudo: false
language: node_js
node_js:
- 10.13.0
branches:
  only:
  - staging
cache:
  bundler: true
  directories:
  - node_modules
  - packages/web/public
  - packages/web/.cache
  - packages/checkout-objects/node_modules
  - packages/data-objects/node_modules
  - packages/gatsby-source-wordpress/node_modules
  - packages/mail-server/node_modules
  - packages/server-env/node_modules
  - packages/server-middleware/node_modules
  - packages/templates/node_modules
  - packages/web/node_modules
  timeout: 1000
before_install:
- curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 1.12.3
- export PATH=$HOME/.yarn/bin:$PATH
script:
- yarn bootstrap
- yarn stage
env:
  global:
  - STAGE=staging
  - secure: Z0tpka/zYHlFxqeqfehg+3PBHvJyjV+CnHeyKXFiwB0ijZSV0iq5opXHbtn65ccxU1HjUYjdNvOA1lEfXcbkdbIdasSnsW1fagM2leuDcue7Puvkg+Nf21mc5f6YoAjx60WjaDMDS1WtyS6iukJ739FW/FzWtwsdeaDpYVi+RPJ00pm9xh9zs/qagY+bVVUHdgypBo5olCxkpsxafLcZatiCydHrhNA67KlXooKjsU/fwuA7VO8Yjjr09tuBqupnK8wmAPinLcep2zxUJ8OLpmVXuoBoia8gS7bj/dl3ci6wnfuIZQJ4ZTfzNRSHujYFBqlesKccZSpRjVOXTAEcRYp/tQSJD5UqJUIhyr/FL4X8lOr4Lx0BISK/EwfUe9X8heDL7hDlUDPXWBCe+98K7T90465CG86JTXk9SyD/J8AuWJ9qH/U/YHnlbY57M2Yocj7m0tXM4kOIGJ0YRbrDSRA4f+Xcw/A2nNwraqdkSRNMju6gZZharUY+FqJY1qW2k2iBASjceWE3s8ZHOaw/V5IapNJ4jr+lkqAoVANGDy4zppdFFsv4PUsgpy+qCZFNXqch0ierhAa7NSluTaPVVGCrCXBVSluvWs97jTP4WVhfmZIqXbvldAVWJsLExnv9IthbrPACOlv0r+l9zTw9JqUg29+apxwfuxpw6CpPHSg=
  - secure: o2TAQUoXrpI8JGhMLp6COjDVKjPuKP4gZHZfmQcySkpYbqpCBYehwzRR1dbY4hdl5DhVA+jXU91SHJuGTAuAyL3CDPxvJaLtrU77ZAmZthdIdQRAElrCLmz41wsuOM7aTxkWl9bLBH5yeIBa+lpUxUsfGtWJQsFFFEDCmWlrFDwV4SxcGRQ6CQd61m3wTeeB7Mks6idq8evjfUYnqJOqXGKYD9JrahX779ZtJ+BUjXdqRFe7BhwJl8KhYJcbti4Yas1CmweLUWC2VQ+8GFxNAjVqC5vYpXZ+5zBMgNuoIg82SkBPawFXs/HJX36Z7Xi9v79xifu3mgCasx/7NMQeyztyE8aQrOEys91Tmm18ZAut2XPkKQD3fyvswbITDszStnpXDcHEAeLgbWa5vu/qDAzH96OYrF29P22NXVZYmlJ1PxmJpbNK2ef1UF9vAXiwVOgIt5hZBFBIiAH8HHLUkoigBLleXI+XwSh9nRGGE3bBWrFM+I8fmu7+9t/mIz+qW6x+uUUNjfr13eSBq+pUALRE4bmrlTc84t2WNIG50k1tUVDIVLSyPaBzrxtfdaxO7wdAhNZQW9O4ViP4Sj6ayxep5U3xWuR/McnVCKTZuNk0chiyLYrdt/EWkxH10WF7tPRqSoTMc8KD5sR2BPIfx9Ov9e1rwp+3mpDi+EVHTBU=
  - secure: Nh3oHNc1Xlc0zIyNyvI0FeHPO0a3jMd7fLXT6gEYPEenc3HRy3Fn0bP5lI6QAcCzzyaWnlQWCbY0mTDySen2Emhhs+XQiCsspWnVkBaZsp/jXmN2G/zMc6A2uXXwz7EBV2XzRq9QcPdqoSenv6UJpeINgpEez/mKvcnZQ8xMOY14txZfozdP3CB8Z4izpdWDzsqp8x41OGEsmFRjDYIt18rAk46TPH7QQvGpVSCyZgHNDRfvBSSoGEHdsJgdBgBu0/v1FBuLDU5MYkq92Gj2RHIs4hIsL2YxViQi62Bb5ghreAPWw8ZvvvZ/g3b8zAYYOIBdnrSHQ0TefGs/LNNVk6CQmK3gT8TG6Icd1+HLYiajX8CZPHWPaCaFlaYsMFJbgK3RLuLIf2LQm8rky8hw8v9x41oVPbGQZJOzo0T6s/x+HNXYB+/2GHSud+zG+/xi7ShpTxhnm6PyDlKItOhgOK3FDPsHcW0FtxoTEUjHTrDTPjlqw8X+tMEV6qrhncJyfK3hsmtudSxrMD7WB0GMdja/En2QIRgoYliRQh8FDE3BJiFkgcbhPbdY8ll+RZijHZvoIru5oulyXpkLFb0PB2ufJZLPp0NjiurLArR1hLo/vRjDbZxPKsNCf1cc5bNU5qXCQ7cIYBp1sbDkRr4fYMXK5DaV11zztai/eRkJUN8=
  - secure: EjMXbJZYtMgLsrQEtFAwqzEHu3QjFCFHGs+NlCYDI78Vefk6cKUz5gc2OqHi5m+/T6npIYtgJyck8N1yfGS0/TMB8QUd3SLDfhvHQ4HgAafxct9A3+/vVew7ol54ldq7EAyR1kcUan2eDFh/SCmZ+owIL8b5G6Me9ek96//GlnQstorCpmaPZh+QqP3KTZUfSmZjPat62xAZvlZWpCPLWMabpYFam2mckcjDgMQ7TWUAs3mDsjIM106VfOGhD3kW9foWrhLClLDPcXxgt0iIMJz4eTyD0/8koJ/fkDxoaDaWX/MK8S6y07KKrQnpjuGiDpo3oQCMF+AM7blxhETfeVuGIZkleuy49E+fltwo+NpwHUja69xT/ei29E78k1cywk7NBYLgGsvqDoxdyBV9c9MjFExydrPpU8/rSRTLUKsDOlKHS9/LUn8BFzUBiScBWoFqyVWsrFNBtBIlAHeHTT4Aj2snhPk+otKr8Ardy3i2NVxXcz8YlFh1M1zyfaqN4LCxyK0OoNBRxILytKIYA32MO5wDI9tUdEOAJs9VLBRdvAPkL7hLbo59IPl9/1EoGb+f1YOUkuot3ixcoccrUS1lI31hGysR9YKBdc0fw2QZrAzIhO3DsQ8l9FW+LJklQv6h6/196AxQKxF/yR1BizkdASsxuOKqdFAvx/HyIaY=
  - secure: LI9J2ko6U1kGplJFhVcTIF15Mr3amjemGxCWGlLk36FOCqguZ0CM4t+IGrFZ4hmh/TZovSTVisQEuiKX/90kOhxqG+Q8o0BzGM2TKxBdDAJ9sdJ6YO9m/jy9rULVaIj9W7uaqnsHgJy4Z6TV3AmD/Lw5eKShpdDfEX0s2C8fK6g4JCr35qKJjheQP9vbgrO+Zrxuo3FEe5ELSnjaA1cLxp4TQNE5i1HLt2fRvM+dJP2LAFHaiVy61+hBFR2RDgHZ5Sv6rEWuXdmD4CTv4xZf8rQ/fVb+6bA1RyCxpUcXJdYAZwrQNLaBbwh442cT38pZxdnzlwvUwYxg4LUhBvOepiqf8627qtjf7rFO6XdDYIo7q6N2fxuFz1PAWkAKlPHAOmGGEoXLQNHrJ4mGgjhkRFA07mBgQuuc8dA4Ymy6WoJDgc5ElyJFOVyweRzeY2TU1P5kLZlAELUVr5WXT4bqeDcxRBOcQEZKJaiCkIahiBM4bwUCR9fdp+OMJZO8sM2QYyhgNpFjjJlOKhBTo/EpKHY0WIrgXqnELhcttBekI5xA50jMrkssXx/CKB+wo/th4Y6qHL6g+A61FSI4jiaB1H0PlrWiwtIMin0+oC088xe0glOgqp58qyQUK02oVpAwAm174pjvfOoQ8mbXg8VxEn5J9cxTCZUCcNjzl2cXXbQ=
  - secure: cYzKymfP8D8T56TzRPCoyuIcTC5w9AtGRCrUEK3xqHse0SaTaRpg8+Kv3YuIPwUyxUNPcCBkYiHFGTAKCjrdj3y8HWiMoRlECyzTruRDBLUS3X53IO33fycULMvzi8e+jMkfA68e7Sr8Emz6FiQMrhwungIfwxQyhnWls1cyST4CCd1qItwznkgObcJvxXlyi0hWX0VyU4mQJ54rl5VC9D0sh4L5L5RtVsjL+s18CXqLyspAGw57WKeCWgdn0/oAjtn8zCRDiP8LFBCOLeUX+vkn6o0TtAxwTK4/ndQOfQKuQWVb1D8PB30gJV0F49nbwZpVEFqHAnJz0XNhLuBBfm0B6aXowefDXzzhnNh/LzmLGuVy2C1f0dX4V1BA7PSH+oLNlFwvIznlU/3/O3JkFa+53PkfVw8Ie8Is5HNTT8BzewIf3T6HK36y30tm6RUlZWa2MSrdWAeRrapwRYe4DG5S8XsxARp4b46mJdXlnMudZ2aZ2FDvY7pz2T1rWoSNkgtlFHqTpX6yUWuSOtVisOrMKqkQ52CXTpVDhbNjzcwahPW6XiT0hxyfSL+tLlwhhLjXEh+LK6Rieo4TKbZZhyQls1Qnlk0sYZZ5PwbfvCVYsCrDiJZqyiXbZyEaQGF7CDy7z9LC6lACiRpzg/TVyAX5/k6j6mBqIokCRtwE2Ss=
  - secure: uRo+47S75OO4zUBctwMjshpgUqn7QCuGU6GZylfWPQN/8ro4hCN77MNvh1vEXDiVEka+7dMLgBwEvQvpnc1HxOG6BGRSY5T0ClpWTVclhEUyP0lz49H7Yrs2yZtx/mMLqh2ztaJ5Y9L/hQsNjjMRn8ws9WOaxhKlHzRFIw7GwqiPhezZK90Jg8vdTvqJ6scmY749MV5Qh50G4rYnjJt4n/9H/W2H6WKMhAPAKH3RCTENHLeaqyLf5Kl7vRKdPD2v/16OYH0m4pER0ZyqMgkINhHiqQ5RQG8V6bCUYObMjekAESB9mmVsQ2n6diCtlDekovckKGzQHyzhY2PQfMNhWfgqO5fyPVukkMuZQ1+EjQvG8am99uyXWK3QRlje+SinARFfqK4KaOxlkS81Hdkur6mfzvZIxm4W96ubo0LrtF9ZH30MxiyF8ugwXRzWWLGE3ZZlPjnK4M3cyyd02az7+m7kUigfGNJk7Z3+hHxfqa4KuR6s9cCM85tVdW8mnTLcAHvPjlcblExoapu1uCUezb3/xgF3PqJCcqytoVnAnAyntIEgvuGxgp/4SLQVmKvvSUASqdO7++Bbw5PnX/hlUhi5xovWUpvH3Z6aQVNm4lp7+QRZY8+kyVIds9tVkPOfLSoZUPfbv/BMS6ugKKb6un/kGIcbvh8MIKaozBifcgk=
  - secure: OtaFf0z4zVfqXJFYkdYDnPbynYPLDALsXtNMmSkqfB78JUTmhkpbtqyMo9/l/AX3ka2vUy7eDBiD4js4Z7lv23bCKoTIYWovnPujTTDwuUp3Ds/lmorCqC7rKgocxM7wrzkyV3C5DNoQ4EgPItzQDQZ6i8XW5pGPgKBAztMeA/HtAa4hCWYypnQ6/s5s8IIGKGpghmZ5TI7UokuwNdJF8/K6RH9Tifl0yl2aoMECTOwtVtYXChBmLKS7cnPlBL3p5zerc+KGNfydFMrWpC5N0GxN8REzRm7Va14Og4zOvWGSPAGNpPxJZ6F/61lxmsPfvv25zHVQDRdggR9jLv3VALvaDAmsfDH89NAL6BQlT8xqoOxuYqAgW622exdj0MKLUvwUL/Qt/KEQJDRjMWg5HCujsB7cqalJdya4KJeS1VWfT3htyXHFdwQhcF4Ew3pfNVf3ZakuBsdJkUxZZduEnypkoc4sPfBPI5OqsEAPyg0s/FgXFUQlycem1gV9+eSFCJnP19tN7g/6jMrofurlGjCWjaYKMZWeykErHYN8bwGoe+xNFK4toOnLd8ZdTVPdLVWG06ipaXSqpLUu6VwPTsAfgDuD3SWdCH27MHw0H0j5fwpKf9T5gwvFEkr8O1SGWZpQCftgyp622LcSHKeMan01K7MTVoc4cL5MVfoC+zc=
  - secure: rbA8KjAwXERJGk0TXnGUbVWggVr4fYv5Nq9kOLtXLufBsSq80PhNShMArw+ACl3AQURnBWDfLoFFsAYWDbxTQj1AOFBA/nMtEvKmNlfr2a+FYPME0pt6YGONnNWqxU0f4ewWsh3M3NRgPhFgxmJyiZG4Sel5to8N3WIuuEn6ETwmPgvcvTjh2P8nc/qYGBZzA72r4vfgpR+18Ueao+YHeH7lO3ELZFnkN8Yv5SEJm9mXWd1D1OGBBIbOiWq02h/fttdCJW+Sqo37NqCwep44NAr+8S51RIaNYbzpffFPjsoEY5ImOpytmM61J+8FlICD2osZUaEs3wGjFh1QNEHhGJAuG7g+Mqqfg/D7z/jr/nVjLsYyu7EvsQArjpZAduM/ruyJOH1Pga7of+tYeFheUXAVkDnc9/ndtpLsmcDMUop/1Wt2JQhMzQDK3VXiiZMNuRmO++UMBkbPRyVJC3Lka7BNJTXufvDL6zt0+GwtjO4nYQ8gkkqu32Zn29HNyNOSGPEgkLCwcH7eKY12cYSa7wN7vv38fC5S8qXHLadcOn63h+qdrx13EGmRT0/VDeItoeO2kjZkGdeUgx91dteC3fahmmigFun9311aKBnfKf8oIT6sIwqDH0BgKdHDBEK36zXRtIAh4rFq4pu9y5bDQlO89aJ98niucUyMAu6ykeo=
