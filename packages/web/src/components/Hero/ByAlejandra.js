/** @flow */
import * as React from 'react';

type Props = {
  strokeWidth: number | string,
  stroke: string,
  frameRate: number,
  interval: IntervalID | null,
};

type AnimationState = {
  strokeDashoffset: void,
  strokeDasharray: void,
  status: boolean,
  interval: null | IntervalID,
};

type State = {
  by: AnimationState,
  alejandra: AnimationState,
};

class ByAlejandra extends React.PureComponent<Props, State> {
  static defaultProps = {
    stroke: '#ffffff',
    strokeWidth: '3',
    frameRate: 10,
  };

  initialAnimationState = {
    strokeDashoffset: undefined,
    strokeDasharray: undefined,
    status: false,
    interval: null,
  };

  state = {
    by: this.initialAnimationState,
    alejandra: this.initialAnimationState,
  };

  by: HTMLElement;
  alejandra: HTMLElement;

  animateStroke = (element: string) => () => {
    // console.log(element);
    this.setState(
      (state) => {
        if (state[element].strokeDashoffset > 0) {
          return {
            [element]: {
              ...state[element],
              strokeDashoffset: Math.max(
                state[element].strokeDashoffset - 5,
                0
              ),
            },
          };
        } else {
          return {
            [element]: {
              ...this.clear(state[element]),
            },
          };
        }
      },
      element === 'by' ? this.startNext : () => null
    );
  };

  clear = (slice: AnimationState) => {
    if (slice.interval) {
      clearInterval(slice.interval);

      return {
        interval: null,
        status: true,
      };
    } else {
      return {};
    }
  };

  setInitialState = (element: string) => {
    this.setState((state) => ({
      [element]: {
        ...state[element],
        strokeDasharray: this[element].getTotalLength(),
        strokeDashoffset: this[element].getTotalLength(),
      },
    }));
  };

  startNext = () => {
    if (this.state.by.status && !this.state.alejandra.status) {
      this.startAnimation('alejandra');
    }
  };

  startAnimation = (element: string) => {
    this.setState((state) => ({
      [element]: {
        ...state[element],
        interval: setInterval(this.animateStroke(element), 10),
      },
    }));
  };

  componentDidMount() {
    this.setInitialState('by');
    this.setInitialState('alejandra');
    // start animation
    this.startAnimation('by');
  }

  componentWillUnmount() {
    this.clear(this.state.by);
    this.clear(this.state.alejandra);
  }

  render() {
    return (
      <svg
        version="1.1"
        x="0px"
        y="0px"
        width="100%"
        height="auto"
        viewBox="0 0 526 86"
      >
        <path
          fill="none"
          stroke={this.props.stroke}
          strokeWidth={this.props.strokeWidth}
          strokeLinecap="round"
          strokeLinejoin="round"
          strokeDasharray={this.state.by.strokeDasharray}
          strokeDashoffset={this.state.by.strokeDashoffset}
          ref={(svg) => (this.by = svg)}
          d="M0.5,13.184
	c4.825,18.337,6.394,25.092,7.097,31.124c0.704,6.032,0.543,11.34,0.222,14.416c-0.321,3.076-0.802,3.92-0.35,1.712
	c0.452-2.208,1.835-7.467,3.583-11.325c1.748-3.858,3.86-6.316,6.127-8.272c2.268-1.956,4.691-3.41,7.08-4.293
	s4.743-1.194,6.82-1.212c2.077-0.017,3.877,0.26,5.453,0.866s2.926,1.541,3.67,2.666c0.745,1.125,0.883,2.441,0.762,3.774
	c-0.121,1.333-0.502,2.683-1.298,4.137s-2.008,3.012-3.462,4.432s-3.15,2.7-5.332,3.825c-2.181,1.125-4.847,2.095-7.599,2.874
	c-2.752,0.779-5.591,1.368-7.253,1.679c-1.662,0.312-2.146,0.346-2.441,0.467c-0.294,0.121-0.398,0.329,0.688,0.264
	c1.086-0.066,3.363-0.404,5.246-0.82s3.374-0.908,5.325-1.544s4.365-1.418,6.374-2.21c2.01-0.792,3.616-1.596,5.378-2.453
	c1.762-0.857,3.681-1.766,6.139-3.01c2.458-1.244,5.455-2.823,7.958-4.531s4.511-3.546,6.042-5.509
	c1.53-1.963,2.582-4.052,3.126-5.193c0.544-1.141,0.58-1.334,0.58-1.214c0,0.121-0.036,0.556,0.163,1.274
	c0.199,0.718,0.634,1.72,1.255,2.535s1.431,1.442,2.33,1.811c0.899,0.368,1.889,0.477,2.969,0.52
	c1.081,0.042,2.251,0.018,3.332-0.175c1.081-0.193,2.07-0.555,2.938-1.051s1.611-1.126,2.491-1.923
	c0.88-0.797,1.896-1.76,2.754-2.849c0.858-1.089,1.559-2.304,2.095-3.284c0.536-0.98,0.909-1.725,1.214-2.195
	c0.306-0.469,0.544-0.663,0.842-0.588c0.298,0.074,0.656,0.417,1.029,0.964s0.761,1.297,1.145,2.203
	c0.384,0.906,0.763,1.966,1.478,3.4s1.768,3.242,3.282,5.708s3.491,5.59,5.509,8.686s4.079,6.164,5.495,8.453
	c1.417,2.289,2.188,3.799,2.791,5.372s1.034,3.208,1.363,4.935c0.33,1.727,0.557,3.543,0.443,5.247
	c-0.113,1.704-0.568,3.293-1.147,4.429s-1.283,1.817-2.408,2.669c-1.124,0.852-2.669,1.874-4.373,2.476
	c-1.704,0.602-3.566,0.784-5.395,0.92c-1.828,0.136-3.623,0.227-5.769,0.079c-2.146-0.147-4.645-0.534-6.871-1.238
	s-4.18-1.726-5.997-2.907s-3.498-2.521-5.156-4.066s-3.293-3.293-4.259-4.883c-0.965-1.59-1.261-3.021-1.352-4.123
	s0.023-1.874,0.352-2.623c0.33-0.75,0.875-1.477,1.825-2.391c0.95-0.914,2.306-2.016,4.48-3.185
	c2.175-1.169,5.168-2.406,8.213-3.601c3.045-1.195,6.142-2.347,8.458-3.127c2.317-0.78,3.855-1.188,6.569-1.906
	c2.714-0.719,6.604-1.747,12.067-2.988c5.464-1.24,12.501-2.692,24.56-5.959"
        />
        <path
          fill="none"
          stroke={this.props.stroke}
          strokeWidth={this.props.strokeWidth}
          strokeLinecap="round"
          strokeLinejoin="round"
          strokeDasharray={this.state.alejandra.strokeDasharray}
          strokeDashoffset={this.state.alejandra.strokeDashoffset}
          ref={(svg) => (this.alejandra = svg)}
          d="M198.677,15.689
	c-5.132,6.226-8.792,11.273-11.687,15.494c-2.895,4.22-5.026,7.613-6.709,10.263s-2.916,4.557-4.178,6.478
	c-1.262,1.921-2.552,3.855-3.407,4.977c-0.855,1.122-1.276,1.43-1.599,1.5c-0.322,0.07-0.547-0.098-0.561-0.841
	c-0.014-0.743,0.183-2.061,0.673-3.856c0.491-1.794,1.276-4.066,2.313-6.87s2.327-6.141,3.589-9.296
	c1.262-3.155,2.496-6.127,3.744-8.932c1.248-2.804,2.51-5.44,3.575-7.585c1.065-2.145,1.935-3.799,2.608-4.725
	c0.673-0.925,1.15-1.122,1.626-1.08c0.477,0.042,0.954,0.323,1.991,1.528c1.038,1.206,2.636,3.337,4.192,5.342
	c1.557,2.005,3.071,3.884,5.749,6.548c2.678,2.664,6.52,6.113,9.815,9.1c3.295,2.986,6.043,5.51,8.202,7.319s3.73,2.902,4.641,3.688
	c0.912,0.785,1.164,1.262,1.22,1.57c0.056,0.309-0.084,0.449-1.851,0.21s-5.16-0.855-8.09-1.36c-2.93-0.504-5.398-0.897-8.034-1.191
	c-2.636-0.294-5.44-0.491-8.09-0.729c-2.65-0.239-5.146-0.519-7.698-0.785c-2.552-0.267-5.16-0.519-7.059-0.721
	c-1.899-0.202-3.09-0.354-3.688-0.528c-0.597-0.175-0.602-0.373-0.566-0.61c0.036-0.238,0.112-0.516,0.39-0.739
	s0.757-0.392,4.31-1.166s10.177-2.155,14.397-2.993s6.038-1.133,8.218-1.599c2.181-0.466,4.725-1.102,7.19-1.938
	s4.852-1.872,6.829-2.958c1.977-1.086,3.544-2.222,5.25-3.719c1.705-1.497,3.548-3.356,4.802-4.925
	c1.253-1.569,1.917-2.849,2.605-4.234c0.687-1.386,1.398-2.877,1.71-3.738c0.312-0.861,0.225-1.091,0.031-1.233
	c-0.194-0.143-0.495-0.198-0.848-0.099s-0.756,0.353-1.085,0.847c-0.329,0.495-0.582,1.231-0.772,2.123
	c-0.19,0.891-0.317,1.937-0.481,3.486c-0.165,1.549-0.368,3.604-0.246,5.494c0.121,1.891,0.566,3.617,1.055,5.051
	s1.023,2.574,1.667,3.632c0.644,1.058,1.398,2.033,2.282,2.815c0.883,0.782,1.895,1.371,2.778,1.785
	c0.883,0.414,1.638,0.653,2.438,0.708s1.646-0.074,2.426-0.262c0.779-0.188,1.492-0.437,1.991-0.722
	c0.5-0.285,0.785-0.607,1.05-0.971s0.509-0.769,0.699-1.234c0.189-0.465,0.325-0.99,0.393-1.445
	c0.067-0.455,0.067-0.839-0.021-1.273c-0.088-0.434-0.265-0.917-0.517-1.141c-0.252-0.223-0.579-0.187-0.904-0.106
	c-0.325,0.081-0.647,0.205-0.883,0.486s-0.387,0.717-0.405,1.221s0.096,1.076,0.277,1.658c0.181,0.583,0.429,1.175,0.839,1.805
	c0.41,0.629,0.983,1.294,1.8,1.771s1.879,0.763,3.111,0.906c1.231,0.144,2.632,0.144,3.929,0.046
	c1.296-0.097,2.489-0.291,3.785-0.664c1.296-0.373,2.697-0.924,3.914-1.629c1.217-0.704,2.249-1.561,3.284-2.52
	s2.073-2.021,2.9-2.966c0.827-0.946,1.443-1.777,1.917-2.663c0.475-0.885,0.807-1.823,0.905-2.454
	c0.098-0.63-0.039-0.953-0.225-0.733c-0.186,0.22-0.42,0.983-0.567,2.01c-0.147,1.026-0.206,2.317,0.16,3.888
	c0.365,1.571,1.154,3.422,1.806,4.921c0.652,1.499,1.168,2.647,1.965,4.067c0.798,1.42,1.877,3.114,2.943,4.891
	c1.066,1.776,2.117,3.636,3.014,5.41c0.897,1.774,1.639,3.462,2.18,5.147c0.542,1.685,0.882,3.366,1.084,5.28
	s0.265,4.063,0.17,5.975s-0.347,3.586-0.926,5.04c-0.58,1.454-1.485,2.686-2.426,3.771c-0.941,1.085-1.916,2.023-3.338,2.844
	c-1.423,0.82-3.293,1.523-4.928,1.985c-1.635,0.462-3.033,0.683-4.496,0.729c-1.462,0.046-2.99-0.083-4.581-0.405
	s-3.247-0.837-4.636-1.545s-2.512-1.61-3.487-2.677c-0.975-1.067-1.803-2.3-2.346-3.588c-0.542-1.288-0.8-2.631-0.81-4.094
	c-0.009-1.462,0.23-3.045,0.727-4.517c0.497-1.472,1.251-2.833,2.373-4.213c1.123-1.38,2.613-2.778,4.723-4.135
	s4.841-2.672,7.319-3.716c2.479-1.044,4.704-1.816,7.464-2.543c2.76-0.727,6.053-1.408,9.346-2.192s6.583-1.671,9.971-2.629
	c3.388-0.958,6.872-1.986,10.265-3.117c3.393-1.131,6.696-2.364,9.176-3.413s4.135-1.914,5.644-2.925
	c1.509-1.012,2.87-2.171,3.873-3.248s1.646-2.07,1.996-3.036s0.405-1.904,0.221-2.576c-0.184-0.672-0.607-1.077-1.141-1.279
	c-0.533-0.202-1.177-0.202-1.849-0.156c-0.672,0.046-1.371,0.138-2.116,0.303s-1.536,0.405-2.3,0.727
	c-0.763,0.322-1.5,0.727-2.162,1.141c-0.663,0.414-1.251,0.837-1.739,1.297c-0.487,0.46-0.874,0.957-1.232,1.527
	c-0.359,0.57-0.69,1.214-0.792,1.84c-0.101,0.625,0.028,1.232,0.35,1.637c0.322,0.405,0.837,0.607,1.545,0.57
	c0.708-0.037,1.61-0.313,2.604-0.717s2.079-0.938,3.045-1.536c0.966-0.598,1.813-1.261,2.604-1.896
	c0.791-0.634,1.527-1.242,2.346-1.849c0.819-0.607,1.72-1.214,2.41-1.583c0.69-0.368,1.168-0.497,1.729-0.153
	s1.205,1.159,1.762,1.922c0.558,0.764,1.028,1.476,1.56,2.11c0.531,0.633,1.123,1.189,1.702,1.694
	c0.58,0.506,1.147,0.962,1.817,1.354c0.67,0.392,1.442,0.721,2.088,0.927s1.165,0.291,1.828,0.126
	c0.663-0.164,1.47-0.577,2.269-1.158s1.588-1.329,2.355-2.031c0.768-0.702,1.513-1.358,2.243-1.954
	c0.73-0.596,1.445-1.132,2.108-1.58c0.663-0.447,1.274-0.805,1.997-1.036s1.558-0.335,2.325-0.276
	c0.767,0.06,1.468,0.283,2.213,0.596s1.535,0.715,2.25,1.11s1.356,0.782,1.9,1.095s0.991,0.551,1.431,0.663
	c0.439,0.112,0.872,0.097,1.319-0.022c0.447-0.119,0.909-0.342,1.364-0.7c0.454-0.358,0.901-0.85,1.341-1.304
	c0.44-0.454,0.872-0.872,1.349-1.281c0.477-0.41,0.999-0.813,1.505-1.11s0.999-0.492,1.587-0.492c0.588,0,1.274,0.194,1.907,0.477
	c0.633,0.283,1.215,0.656,1.766,1.043c0.551,0.387,1.073,0.79,1.96,1.263c0.887,0.474,2.141,1.018,3.426,1.332
	s2.604,0.398,3.978,0.37c1.374-0.028,2.804-0.168,4.318-0.463c1.515-0.294,3.113-0.743,4.403-1.234s2.271-1.023,3.197-1.64
	c0.925-0.617,1.795-1.318,2.496-2.183c0.701-0.864,1.234-1.892,1.43-2.761c0.196-0.87,0.056-1.581-0.351-2.062
	s-1.08-0.734-1.851-0.832s-1.641-0.042-2.444,0.193c-0.803,0.236-1.54,0.651-2.259,1.105c-0.718,0.454-1.419,0.945-2,1.616
	s-1.043,1.52-1.274,2.228s-0.231,1.274-0.179,1.878s0.157,1.244,0.492,1.863c0.335,0.618,0.902,1.214,1.662,1.535
	c0.76,0.321,1.714,0.365,2.638,0.351c0.924-0.015,1.818-0.09,2.72-0.239c0.901-0.149,1.811-0.373,2.712-0.76
	c0.902-0.388,1.796-0.939,2.66-1.587c0.865-0.648,1.699-1.394,2.541-2.168c0.842-0.775,1.691-1.58,2.526-2.415
	c0.835-0.834,1.654-1.699,2.828-3.625c1.174-1.926,2.701-4.914,3.63-6.923c0.929-2.009,1.26-3.039,1.513-4.167
	c0.253-1.128,0.428-2.353,0.456-3.292c0.028-0.938-0.092-1.59-0.363-2.025c-0.271-0.437-0.695-0.657-1.219-0.593
	s-1.15,0.414-1.625,1.079s-0.799,1.644-1.177,2.711c-0.377,1.067-0.807,2.221-0.948,3.388c-0.141,1.166,0.006,2.344,0.107,3.585
	c0.101,1.241,0.156,2.545,0.46,4.058c0.305,1.514,0.858,3.237,1.497,4.667c0.638,1.431,1.36,2.569,2.349,3.629
	c0.988,1.06,2.243,2.042,3.46,2.926c1.217,0.885,2.397,1.672,3.681,2.438c1.284,0.766,2.671,1.51,4.017,1.688
	c1.346,0.178,2.65-0.211,3.717-0.729s1.895-1.164,2.566-1.834c0.672-0.671,1.187-1.366,1.454-2.247s0.285-1.948,0.294-2.912
	s0.009-1.825-0.161-2.426c-0.17-0.601-0.511-0.943-0.768-0.938c-0.257,0.005-0.429,0.356-0.447,0.688s0.119,0.645,0.652,0.86
	c0.533,0.216,1.462,0.334,2.897,0.346c1.436,0.011,3.377-0.085,4.879-0.161c1.502-0.076,2.564-0.13,3.729-0.277
	s2.432-0.385,3.76-0.717c1.328-0.332,2.716-0.756,4.025-1.175c1.31-0.419,2.541-0.832,3.508-1.232s1.67-0.789,2.148-1.016
	c0.478-0.227,0.731-0.293,0.852-0.133c0.121,0.161,0.109,0.549,0.048,1.406c-0.06,0.858-0.169,2.186-0.205,3.169
	c-0.036,0.984,0,1.624,0.133,2.275s0.362,1.316,0.682,1.889s0.73,1.056,1.316,1.479c0.585,0.422,1.346,0.784,2.354,1.183
	c1.008,0.398,2.264,0.833,3.989,1.125c1.726,0.292,3.921,0.441,5.793,0.411s3.422-0.239,5.18-0.743
	c1.757-0.504,3.723-1.304,5.605-2.332c1.883-1.027,3.683-2.283,4.888-3.383c1.205-1.099,1.813-2.042,2.096-2.943
	c0.283-0.902,0.241-1.762-0.026-2.423c-0.267-0.662-0.759-1.124-1.444-1.362s-1.565-0.253-2.377-0.149
	c-0.813,0.104-1.558,0.328-2.191,0.611s-1.155,0.626-1.639,1.183c-0.484,0.557-0.932,1.328-1.155,1.951
	c-0.223,0.623-0.223,1.098-0.031,1.665c0.191,0.567,0.575,1.227,1.179,1.737s1.427,0.869,2.593,0.965
	c1.167,0.095,2.676-0.073,3.995-0.583s2.447-1.361,3.451-2.357s1.883-2.138,2.494-2.842c0.611-0.705,0.954-0.973,1.334-1.081
	c0.38-0.108,0.799-0.055,1.192,0.413c0.393,0.467,0.761,1.35,1.341,2.187c0.58,0.837,1.371,1.629,2.542,2.517
	c1.172,0.887,2.724,1.868,4.233,2.485s2.976,0.869,4.561,1.064c1.585,0.196,3.288,0.336,5.18,0.392
	c1.892,0.056,3.974,0.027,9.104-1.304"
        />
      </svg>
    );
  }
}

export default ByAlejandra;
